<!DOCTYPE html>

<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>TP3 - Thiago Arag√£o</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">
</head>
<body>
	<header class="p-3 bg-dark text-white">
		<div class="container">
			<div
				class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">

				<ul
					class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
					<li><a href="/" class="nav-link px-2 text-white">Home</a></li>
				</ul>
			</div>
		</div>
	</header>

	<div class="container">
		<div class="row content mt-2">
			<div class="col-md-12">
				<h1>Edit user</h1>

				<div class="col-md-6">
					<form class="mb-3"  th:action="@{/edit}"  method="POST" enctype="multipart/form-data">
						<input class="form-control" type="hidden" name='id' required th:value="${user.Id}"/>
						<div class="form-group mb-3">
							<label for="name">Name</label> 
							<input class="form-control" type="text" name='name' required th:value="${user.Name}"/>
						</div>
						<div class="form-group mb-3">
							<label for="email">Email</label> 
							<input class="form-control" type="email" name='email' required th:value="${user.Email}" />
						</div>
						<div class="form-group mb-3">
							<label for="phone">Phone</label> 
							<input class="form-control" type="text" name='phone' required th:value="${user.Phone}" />
						</div>
						<div class="input-group mb-3">							
							<input class="form-control" placeholder="Address code" type="number" name='addressCode' id='addressCode' required th:value="${user.AddressCode}" /> 
						  	<button class="btn btn-outline-secondary" type="button" id="load-address" onclick="pesquisacep();">Load address data</button>
						</div>
						<div class="form-group mb-3">
							<label for="street">Street</label> 
							<input class="form-control" type="text" name='street' id='street' required th:value="${user.Street}"  />
						</div>
						<div class="form-group mb-3">
							<label for="number">Number</label> 
							<input class="form-control" type="text" name='number' th:value="${user.Number}" />
						</div>
						<div class="form-group mb-3">
							<label for="complement">Complement</label> 
							<input class="form-control" type="text" name='complement' th:value="${user.Complement}" />
						</div>
						<div class="form-group mb-3">
							<label for="district">District</label> 
							<input class="form-control" type="text" name='district'  id='district' required th:value="${user.District}"  />
						</div>
						<div class="form-group mb-3">
							<label for="city">City</label> 
							<input class="form-control" type="text" name='city' id='city' required th:value="${user.city}"  />
						</div>
						<div class="form-group mb-3">
							<label for="state">State</label> 
							<input class="form-control" type="text" name='state' id='state' required th:value="${user.State}"  />
						</div>
						<div class="form-group mb-3">
							<label for="password">Password</label> 
							<input class="form-control" type="password" name='password' required th:value="${user.Password}" />
						</div>
						<input class="form-control" type="hidden" name='profileImage' required th:value="${user.ProfileImage}"/>
						<div class="form-group mb-3">
							<label for="name">Profile picture</label> 
							<input class="form-control" type="file" name='file' />
						</div>

						<a class="btn btn-outline-dark" href="/Opportunities">Cancel</a>
						<button class="btn btn-dark" type="submit" name="submit" id="btn-submit" >Create</button>
					</form>
				</div>
			</div>
		</div>
	</div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
		crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script>

        
		
 	$("#load-address").on("click", function(){
 		$.ajax({
 	  		url: "/Address/" + $("#addressCode").val()
		}).done(function( data ) {
 			if ( data.cep !== null ) {
 				$("#btn-submit").attr("disabled", false);
 				$("#street").val(data.logradouro);
 				$("#district").val(data.bairro);
 				$("#city").val(data.localidade);
 				$("#state").val(data.uf);
 			}else{
 				window.alert("Address code invalid. Please, change it and try again.")
 			}
 	    });	
 	})
 	</script> 
</body>
</html>